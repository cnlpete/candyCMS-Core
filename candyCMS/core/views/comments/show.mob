{strip}
  <div id="comments">
    <div id="js-commments">
      {foreach $comments as $c}
        <article class='{if $author_id == $c.author.id}from_author{/if}'>
          <header>
            <img class="avatar" src="{$c.author.avatar_64}" width="40" height="40" alt="" />
            {if $c.user_id > 0}
              <a href='{$c.author.url}' rel='author'>{$c.author.full_name}</a>
            {elseif $c.author.name}
              {$c.author.name}
            {else}
              <em style="text-decoration:line-through">{$lang.global.deleted_user}</em>
            {/if}
            <br />
            <time datetime="{$c.date.w3c}" class='js-timeago'>
              {$c.date.raw|date_format:$lang.global.time.format.datetime}
            </time>
          </header>
          <div id="js-comment_{$c.id}">
            {$c.content}
          </div>
          <footer>
            {* Scroll to bottom when quote is clicked *}
            <a href='#' onclick="quote('{$c.author.full_name}', 'js-comment_{$c.id}')"
                data-role='button' data-inline='true' data-icon='quote' data-iconpos='notext' data-ajax='false'>
            </a>
          </footer>
        </article>
      {/foreach}
    </div>
  </div>
  {$_pages_}
  {if $_AUTOLOAD_.enabled}
    <script src='{$_PATH.js}/core/jquery.infiniteScroll{$_SYSTEM.compress_files_suffix}.js' type='text/javascript'></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $('#js-commments').infinitescroll({
          navSelector   : 'div.pagination',
          nextSelector  : 'div.pagination a:first',
          itemSelector  : '#js-commments article',
          loading       : {
            msgText     : '',
            img         : '{$_PATH.images}/candy.global/loading.gif',
            finishedMsg : '',
            selector    : 'div.js-pagination',
            finished    : function(opts) {
              opts.loading.msg.fadeOut(opts.loading.speed);
              iCounter = iCounter + 1;
              if (iCounter % {$_AUTOLOAD_.times} == 0) {
                /** if we did load a few times, we want to stop and display a resume button **/
                opts.contentSelector.infinitescroll('pause');
                var a = $('<a alt="{$lang.pages.more}" data-role="button" class="btn">{$lang.pages.more}</a>');
                a.click(function() {
                  $(this).fadeOut( opts.loading.speed, function() {
                    opts.contentSelector.infinitescroll('resume');
                  });
                });
                $(opts.loading.selector).append(a);
              }
              return true;
            }
          }
        }, function() {
          $('#js-commments article').find('footer a').buttonMarkup();
        });
      });
    </script>
  {/if}
{/strip}
